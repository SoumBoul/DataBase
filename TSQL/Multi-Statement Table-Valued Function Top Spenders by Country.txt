--Create a multi-statement TVF `fn_GetTopSpendersByCountry` that takes `@Country NVARCHAR(50)` and returns `customer_id`, `full_name`, `total_spent`, and `total_orders` for customers from that country, sorted by `total_spent` in descending order, using an internal table variable `@Result`.

create function fn_GetTopSpendersByCountry
(
@Country nvarchar(50)
)
returns @Result Table
(
customer_id int,

full_name nvarchar(50),

total_spent decimal(10,2),

total_orders int
)
as
begin

insert into @Result(customer_id,full_name,total_spent,total_orders)
select
c.customer_id,
full_name,
Sum(total_amount) as Total_Spent,
count(total_amount) as Total_Orders
from Customers c inner join Orders o on c.customer_id= o.customer_id

where country= @Country
group by c.customer_id,full_name

return;
end

output
SELECT * FROM dbo.fn_GetTopSpendersByCountry('France');