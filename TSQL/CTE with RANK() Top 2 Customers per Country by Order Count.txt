--Use a Common Table Expression (CTE) with `RANK()` and `PARTITION BY country` to rank customers based on their total number of orders, and select the top 2 customers per country.

with Average_Orders
as
(
select
c.customer_id,
c.full_name,
avg(o.total_amount) as Total
from customers c inner join Orders o on c.customer_id= o.customer_id
group by c.customer_id,c.full_name

)

select * from Average_Orders where Total>2000